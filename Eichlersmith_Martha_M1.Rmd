---
title: "M1 Midterm I"
subtitle: "Data Visualization (STAT 302)"
author: "Martha Eichlersmith"
date: 2020-05-17
output:
  html_document:
    toc: yes
    toc_float: yes
---


## Overview

Exercises 1 & 2 ask you to replicate plots and provide some basic insight into what the graphics are communicating. Exercise 3 asks you to provide short descriptions/explanations regarding issues and concepts in `ggplot2`. 

You are free to use any resource at your disposal such as notes, past labs, the internet, fellow students, instructor, TA, etc. However, do not simply copy and paste solutions. This is a chance for you to assess how well you have come to know `ggplot2` and determine if you are developing the practical skills needed to utilize `ggplot2` in the future. 

## Datasets 

We will need the instructor provided `stephen_curry_shotdata_2014_15.txt` dataset and the `nbahalfcourt.jpg`. The variables should be fairly straightforward after some inspection of the dataset, but we have provided a description of variables just in case.

* `GAME_ID ` - Unique ID for each game during the season
* `PLAYER_ID` - Unique player ID
* `PLAYER_NAME` - Player's name
* `TEAM_ID` - Unique team ID
* `TEAM_NAME` - Team name          
* `PERIOD` - Quarter or period of the game
* `MINUTES_REMAINING` - Minutes remaining in quarter/period
* `SECONDS_REMAINING` - Seconds remaining in quarter/period
* `EVENT_TYPE` - `Missed Shot` or `Made Shot`
* `SHOT_DISTANCE` - Shot distance in feet
* `LOC_X` - X location of shot attempt according to tracking system
* `LOC_Y` - Y location of shot attempt according to tracking system

<br>

```{r M1-load-package, message = FALSE}
# Load package(s)
library(tidyverse)
library(hexbin)

# Read in the dataset(s)
shots <- read_delim(file = "data/stephen_curry_shotdata_2014_15.txt", delim = "|") %>%
  janitor::clean_names()
```

<br>

## Exercises



### Exercise 1

After replicating the plots provide a summary of what the graphics indicate about Stephen Curry's shot selection (i.e. distance from hoop) and shot make/miss rate and how they relate/compare across distance and game time (i.e. across quarters/periods). 


#### Plot 1


```{r M1-EX1-PLOT1, fig.width = 6, fig.height = 4}

m1_ex1_p1 <- ggplot(shots, aes(as.factor(period), shot_distance)) + 
  geom_boxplot(varwidth = TRUE) + 
  facet_wrap( ~ event_type) + 
  scale_x_discrete(
      name = "Quarter/Period"
    , labels = c("Q1", "Q2", "Q3", "Q4", "OT")
  ) +
  scale_y_continuous(
      name = NULL
    , labels = scales::unit_format(unit = "ft")
    , limits = c(0, NA)
    , breaks = seq(0, 40, 10)
    , minor_breaks = NULL
  ) +
  ggtitle("Stephen Curry\n2014-2015") +
  theme_minimal() +
  theme(
      plot.title = element_text(face = "bold", size = 14)
    , strip.text = element_text(face = "bold", size = 12)
    , axis.title.x = element_text(face = "bold", size = 12)
    , panel.grid.major.x = element_blank()
     
  )

m1_ex1_p1
```



**ADD DESCRIPTION**  

<br> 

#### Plot 2  
```{r M1-EX1-PLOT2, fig.width = 6, fig.height = 4}
ggplot(shots, aes(shot_distance, fill = event_type)) + 
  geom_density(alpha = 0.3) + 
  scale_fill_manual(values = c("green", "red")) + 
  scale_x_continuous(
      name = NULL
    , breaks = seq(0, 40, 10)
    , minor_breaks = NULL
    , labels = scales::unit_format(unit = "ft")
  ) +
  scale_y_continuous(
      name = NULL
    , breaks = NULL
    , limits = c(0, 0.081)
    , expand = c(0, 0)) +
  annotate(
      "text"
    , x = 3
    , y = 0.04
    , label  = "Made Shots"
    , hjust = 0
    , vjust = 0
  ) +
  annotate(
      "text"
    , x = 27
    , y = 0.07
    , label  = "Missed Shots"
    , hjust = 0
    , vjust = 0
  ) + 
  ggtitle("Stephen Curry\nShot Densitites (2014-2015)") +
  theme_minimal() +
  theme(
      plot.title = element_text(size = 14)
    , legend.position = "none"
    , panel.grid.major.x = element_blank()
  )
```
<br>

### Exercise 2

After examining the two graphics, what do you conclude about Stephen Curry's shot selection (i.e. distance form hoop) for the 2014-2015 season? Out of the four graphics (two from Exercise 1 and two from Exercise 2), which graphic(s) do you find the most useful when trying to understand Stephen Curry's shot selection? If you find them all useful, explain what information is better communicated in each.

```{r M1-EX2-base}
# picture of half a basketball court to show the location of shots 
court <- grid::rasterGrob(jpeg::readJPEG(source = "img/nbahalfcourt.jpg"),
  width = unit(1, "npc"), height = unit(1, "npc")
)


#create base plot with court as background
basecourt <- ggplot() +
  #insert half-court to be used as plot background 
  annotation_custom(
    grob = court,
    xmin = -250, xmax = 250,
    ymin = -52, ymax = 418
  ) +
  coord_fixed() +
  xlim(250, -250) +
  ylim(-52, 418)
```


#### Plot 1  
```{r M1-EX2-PLOT1, fig.width = 7, fig.height = 7, dpi = 300, warning = FALSE}
m1_ex2_p1 <-  basecourt +
  geom_hex(
      data = shots
    , aes(loc_x, loc_y)
    , bins = 20
    , alpha = 0.7
    , color = "grey"
  ) +
  scale_fill_gradient(
      name = "Shot\nAttempts"
    , low = "yellow"
    , high = "red"
    , breaks = c(0, 5, 10, 15)
    , labels = c(0, 5, 10, "15+")
    #set limit of shots to 0 to 15
    , limits = c(0, 15)
    # any shots above 15 will be 'na' so set color to high value = red
    , na.value = "red"
    ) +
  ggtitle("Shot Chart\nStephen Curry") +
  theme_void() +
  theme(plot.title = element_text(face = "bold", size = 14))

m1_ex2_p1
```
```{r M1-EX2-PLOT2, fig.width = 7, fig.height = 7,  dpi = 300, warning = FALSE}
m1_ex2_p2 <- basecourt +
  geom_point(
      data = shots
    , aes(loc_x, loc_y, shape = event_type, color = event_type)
    , fill = NA
    , size = 5
  ) +
  scale_color_manual(
      name = NULL
    , values = c("green", "red")
  ) +
  scale_shape_manual(
      name = NULL
    , values = c(1, 4)
  ) +
  ggtitle("Shot Chart\nStephen Curry") +
  theme_void() +
  theme(
      plot.title = element_text(face = "bold", size = 14)
    , legend.position = "bottom"
    , legend.text = element_text(size = 12)
    )

m1_ex2_p2
```

**ADD DESCRIPTION**

```{r M1-EX2-PLOT1-wrap, fig.width = 7, fig.height = 3.62, warning = FALSE, dpi = 300, fig.show = 'asis'}
m1_ex2_p1 + 
  facet_wrap(~ event_type) +
  theme(
      plot.title = element_text(face = "bold", size = 14, margin = margin(0, 0, 10, 0))
    , strip.text = element_text(face = "bold", size = 10)
  )
```

### Exercise 3  

##### Part 1
In 3-5 sentences, describe the core concept/idea and structure of the `ggplot2` package.

<br>

##### Part 2
Describe each of the following:

1. `ggplot()`
2. `aes()`
3. `geoms`
4. `stats`
5. `scales`
6. `theme()`

<br>

##### Part 3
Explain the difference between using this code `geom_point(aes(color = VARIABLE))` as opposed to using `geom_point(color = VARIABLE)`.

<br>
