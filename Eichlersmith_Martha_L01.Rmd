---
title: "L01 Introduction"
subtitle: "Data Visualization (STAT 302) - Spring 2020" 
author: "Martha Eichlersmith"
output:
  html_document:
    toc: true
    toc_float: true
    highlight: "tango"
---

```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo=TRUE)
```



```{r load-packages, warning=FALSE, message=FALSE}
library(tidyverse)
library(ggstance)
library(skimr)
library(plyr)
```


## Exercise 1

Let's look at some interesting patterns in the history of LEGO! We'll be using data from the [**lego** package](https://github.com/seankross/lego) located `data/legosets.rda`. We will work through this exercise together in class.

```{r loaddata}
load(file = "data/legosets.rda")
```


### 1a Inspect the data

The **lego** package provides a helpful dataset some interesting variables. Let's take a quick look at the data.

```{r dataset}
head(legosets)
colnames(legosets)
```


<br>

### 1b Price per year

First, let's look at the average cost of LEGO sets over time. The main variable of interest here is `USD_MSRP`, or the manufacturer's suggested retail price in constant dollars (i.e. not adjusted for inflation).  
```{r priceVtime}
#subset large df (just to make it simpler)
df.subset1b<- select(legosets, Year, USD_MSRP)

df.1b <- ddply( #in the plyr package
  df.subset1b,  #data frame
  .(Year), #column you want to show
  summarize, #summarize the data (i.e. 2014, 2015, ... VS 2014, 2014, 2014, 2015, 2015, 2015)
  AverageCost #name the column 
  = mean(
    USD_MSRP,
    na.rm=TRUE #remove NA's (if false, will not calc mean with NA's present)
    )
  )

ggplot(df.1b, aes(Year, AverageCost))+geom_point()+geom_line()
```


<br><br>

### 1c Pieces per year

Next, let’s look at how the number of pieces per set has changed over time. Because Duplo sets are much smaller (since they’re designed for toddlers), we’ll make a special indicator variable for them.

```{r piecesVtime}
#subset large df (just to make it simpler)

df.subset1c<- select(legosets, Year, Theme, Pieces)

#function: to make theme into binary "Duplo" and "Not Duplo" variable 
myefunc_IsDuplo <- function(input){
  if (input == "Duplo" ){output= "Duplo"}
  else {output = "Not Duplo"}
  return(output)
}

#add binary duplo variable to df
df.subset1c$IsDuplo <- sapply(df.subset1c$Theme, myefunc_IsDuplo)


df.1c <- ddply( #in the plyr package
  df.subset1c,  #data frame
  .(Year, IsDuplo), #column you want to show
  summarize, #summarize the data (i.e. 2014, 2015, ... VS 2014, 2014, 2014, 2015, 2015, 2015)
  AveragePieces #name the column 
  = mean(
    Pieces,
    na.rm=TRUE #remove NA's (if false, will not calc mean with NA's present)
    )
  )

ggplot(df.1c, aes(Year, AveragePieces, color=IsDuplo))+geom_point()+geom_line()
```




### 1d LEGO set themes

In the 1990s, [LEGO began partnering with famous brands and franchises](https://www.cnbc.com/2018/04/27/lego-marketing-strategy-made-it-world-favorite-toy-brand.html) to boost its own sales. First, let's see how many different "themes" LEGO now offers:

```{r numberofthemes}
length(unique(legosets$Theme))
```

